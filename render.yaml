services:
  # الخدمة الرئيسية (الخادم)
  - type: web
    name: digital-services-app
    env: node
    rootDirectory: .
    buildCommand: pnpm install && pnpm run build
    startCommand: pnpm start
    envVars:
      - key: NODE_ENV
        value: production
      # هذا يربط قاعدة البيانات تلقائياً
      - fromDatabase:
          name: digital-services-db
          property: connectionString

  # قاعدة البيانات - التصحيح هنا
  - type: postgresql  # كان pgluster والصحيح postgresql
    name: digital-services-db
    plan: free  # أضف هذا للسعر المجاني
    ipAllowList: [] # اتركه فارغاً للسماح بالاتصال من خدماتك فقط

# إعدادات عامة
version: "1"
